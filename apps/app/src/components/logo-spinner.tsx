'use client';

import { cn } from '@comp/ui/cn';
import { type SVGMotionProps, motion } from 'framer-motion';
import type React from 'react';
import { useEffect, useRef, useState } from 'react';

export interface LogoSpinnerProps extends React.SVGProps<SVGSVGElement> {
  size?: number;
  className?: string;
  raceColor?: string;
  isDisabled?: boolean;
}

export const LogoSpinner = ({
  size = 40,
  className,
  raceColor = 'hsl(var(--chart-primary))',
  isDisabled = false,
  ...props
}: LogoSpinnerProps) => {
  const pathRef = useRef<SVGPathElement>(null);
  const [pathLength, setPathLength] = useState(0);

  useEffect(() => {
    if (pathRef.current) {
      const length = pathRef.current.getTotalLength();
      setPathLength(length);
    }
  }, []);

  const cShapePath =
    'M22.033 7.327a0.802 0.802 0 0 1 0.937 0l5.126 3.68a0.802 0.802 0 0 1 0 1.306l-2.431 1.744a0.52 0.52 0 0 1 -0.598 -0.001l-2.097 -1.505a0.802 0.802 0 0 0 -0.937 0l-6.979 5.01a0.802 0.802 0 0 0 0 1.306l1.955 1.402 2.63 1.891 2.395 1.718a0.802 0.802 0 0 0 0.938 0l6.979 -5.015a0.802 0.802 0 0 0 0 -1.305l-1.654 -1.19a0.263 0.263 0 0 1 0 -0.427l2.873 -2.06a0.802 0.802 0 0 1 0.937 0l5.123 3.679a0.802 0.802 0 0 1 0 1.306l-2.433 1.747 -11.825 8.491a0.802 0.802 0 0 1 -0.937 0l-6.034 -4.333 -2.63 -1.886 -3.163 -2.27 -2.431 -1.747a0.802 0.802 0 0 1 0 -1.306z';

  return (
    <div className="flex items-center justify-center">
      <motion.svg
        width={size}
        height={size}
        viewBox="0 0 394 170"
        xmlns="http://www.w3.org/2000/svg"
        className={cn('', className)}
        {...(isDisabled ? { opacity: 0.5 } : { animate: { scale: [1, 1.1, 1] } })}
        transition={{
          duration: 2,
          repeat: Number.POSITIVE_INFINITY,
          ease: 'easeInOut',
        }}
        {...(props as SVGMotionProps<SVGSVGElement>)}
      >
        {/* New Passt logo path - uses currentColor from className */}
        <path
          fill="currentColor"
          d="M210.91 129c-1.97-.5-5.93-1.82-8.78-2.95-6.53-2.57-6.57-2.57-7.95.45-.62 1.38-1.61 2.5-2.19 2.5-1.32 0-.9-26.9.43-27.25.51-.14 1.92 3.04 3.15 7.05 4.39 14.37 11.59 20.28 20.94 17.2 4.8-1.59 6.9-5.76 5.99-11.87-.62-4.08-1.49-5.33-7.82-11.11-17.71-16.18-21.3-20.27-22.6-25.69-2.19-9.12 1.35-16.37 10.12-20.74 6.77-3.38 18.88-3.64 25.66-.57 5.75 2.61 7.14 2.5 9.82-.77l2.25-2.75.03 12.83c.04 14.6-1.15 16.24-4.23 5.8-2.15-7.32-7.99-14.01-12.48-14.31-9.27-.62-13.25 2-13.25 8.72 0 5.55 1.79 7.67 16.02 18.97 6.43 5.12 12.64 10.82 13.79 12.68 2.92 4.73 4.27 11.52 3.22 16.2-1.05 4.62-6.76 10.83-12.5 13.57-4.78 2.28-14.59 3.3-19.62 2.04Zm128.08.07c-5.71-1.74-8.85-4.15-10.89-8.36-1.85-3.82-2.1-6.15-2.1-19.28-.01-8.21-.3-21.34-.66-29.18L324.69 58h-5.43c-7.14 0-6.76-2.37.45-2.8 4.76-.28 5.1-.48 5.67-3.37.34-1.7.62-5.7.62-8.89v-5.82l4.75-.63c2.61-.35 6.74-1.28 9.17-2.06 2.43-.78 4.64-1.2 4.91-.93.28.27.71 5.22.97 11l.46 10.5h6.29c3.46 0 7 .27 7.86.6 3.36 1.29.14 2.4-6.97 2.4H346v30.5c0 29.59.06 30.56 2.09 32.59 2.83 2.83 6.51 1.87 10.66-2.78 3.89-4.36 5.42-3.63 2.76 1.31-4.38 8.13-13.82 12.09-22.52 9.45Zm-208.49-.52c-.55-.21-2.23-.65-3.73-.98-9.53-2.1-14.22-15.39-8.91-25.3 2.31-4.32 12.42-9.77 26.33-14.21 2.03-.64 4.84-2.08 6.25-3.19 2.43-1.91 2.56-2.51 2.56-11.49 0-10.86-1.3-14.43-5.96-16.37-3.18-1.31-9.7-.8-13.13 1.04-1.68.9-1.52 1.28 1.87 4.39 3.27 3 3.72 3.97 3.72 8.07 0 3.87-.48 5.07-2.81 7.08-3.88 3.34-10.5 3.34-14.38 0-2.41-2.07-2.81-3.16-2.81-7.62 0-4.85.28-5.45 4.22-8.94 7.29-6.48 24.4-9.38 36.08-6.12 5.48 1.52 11.72 7.61 12.52 12.2.32 1.87.89 15.18 1.27 29.59.73 27.74.93 28.7 5.42 26.3 2.46-1.32 2.99-1.26 2.99.35 0 2.38-7.68 5.03-14.59 5.03-7.47 0-11.26-2.12-12.96-7.23l-1.05-3.16-3.45 3.63c-1.9 1.99-4.8 4.2-6.45 4.9-3.2 1.38-11.34 2.64-13 2.03Zm18.64-10.29c1.62-.96 3.17-2.64 3.44-3.75.27-1.11.37-7.79.21-14.85l-.29-12.85-6.7 5.18c-8.26 6.38-11.31 11.82-10.52 18.8.9 7.97 7.23 11.39 13.86 7.47ZM256 114.92c0-15.98 1.12-17.72 4.18-6.52 2.46 8.97 4.1 11.95 8.4 15.23 7.13 5.44 17.25 2.97 18.76-4.58 1.04-5.22-1.15-9.97-7.12-15.42-20.58-18.78-22.44-20.98-23.75-27.91-1.59-8.52 2.24-15.28 10.99-19.35 6.62-3.09 17.22-3.24 24.78-.37 6.59 2.5 8.81 2.52 9.45.07.28-1.06 1.15-2.18 1.94-2.48 1.2-.46 1.39 1.4 1.15 11.68-.17 7.41-.67 12.18-1.28 12.1-.55-.07-1.91-2.77-3.03-6-3.68-10.66-8.57-14.94-16.82-14.72-7.67.2-11.31 8.03-7.07 15.22.98 1.66 4.96 5.4 8.85 8.32 10.04 7.54 18.47 15.7 20.68 20.02 2.25 4.42 2.5 12.73.48 16.59-2.07 3.95-6.47 7.8-11.59 10.12-6.8 3.08-19.15 2.88-27-.42-3.27-1.38-6.41-2.5-6.99-2.5-.58 0-1.49 1.12-2.01 2.5-2.14 5.63-3 2.31-3-11.58ZM30.23 127.23c-3.63-.4-3.45-2.23.22-2.23 1.28 0 3.39-.86 4.69-1.91l2.36-1.91.29-40.38c.34-47.06.25-47.74-6.54-49.08-2.34-.46-4.25-1.29-4.25-1.85 0-.66 10.02-.89 29.25-.66 27.5.32 29.58.47 34.83 2.57 7.2 2.89 13.17 8.05 15.96 13.8 1.86 3.85 2.14 5.76 1.75 12.24-.55 9.19-2.77 14.06-9.04 19.84-6.13 5.65-13.77 8.26-28.06 9.57l-11.86 1.09.34 15.74c.39 18.58.78 19.41 9.43 20.5 6.45.8 6.95 1.94 1.24 2.85-4.1.66-34.28.52-40.61-.18ZM73.04 84c4.15-1.15 9.06-6.03 11.05-11 .95-2.36 1.41-7.58 1.41-16 0-10.91-.28-13.08-2.23-17.02-2.85-5.78-7.14-8.37-13.98-8.43-8.87-.08-8.74-.51-9.1 28.48L59.87 85l4.82-.01c2.64 0 6.4-.44 8.35-.99Z"
        />

        {!isDisabled && (
          // Racing line - uses the raceColor prop
          <motion.path
            ref={pathRef as any}
            d={cShapePath}
            fill="none"
            stroke={raceColor}
            strokeWidth={2.5}
            strokeLinecap="round"
            strokeLinejoin="round"
            initial={{ pathLength: 0, pathOffset: 0 }}
            animate={{
              pathLength: 1,
              pathOffset: [0, 1],
            }}
            transition={{
              pathLength: {
                duration: 0.01,
                delay: 0.5,
              },
              pathOffset: {
                duration: 2.5,
                repeat: Number.POSITIVE_INFINITY,
                ease: 'linear',
              },
            }}
          />
        )}
      </motion.svg>
    </div>
  );
};
